<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>


<h2>ğŸ“ ì¸ì¦ ê¸€ ê²Œì‹œí•˜ê¸°</h2>

<form method="POST" enctype="multipart/form-data">
  {% csrf_token %}

  <!-- ë„ì „ ì„ íƒ -->
  <label for="challenge-select">ë„ì „ ì„ íƒ:</label><br>
  <select id="challenge-select" name="challenge">
    <option value="">ë„ì „ì„ ì„ íƒí•˜ì„¸ìš”</option>
    {% for challenge in challenges %}
      <option value="{{ challenge.id }}">{{ challenge.title }}</option>
    {% endfor %}
  </select><br><br>

  <!-- ì„¸ë¶€ ëª©í‘œ ì„ íƒ -->
  <label for="goal-select">ì„¸ë¶€ ëª©í‘œ ì„ íƒ:</label><br>
  <select id="goal-select" name="goal">
    <option value="">ì„¸ë¶€ ëª©í‘œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
  </select><br><br>

  <!-- ë‚´ìš© -->
  <label for="content">ë‚´ìš©:</label><br>
  <textarea name="content" id="content" rows="5" cols="50" placeholder="ë„ì „ ì¸ì¦ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea><br><br>

  <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ -->
  <label for="image">ì´ë¯¸ì§€ ì—…ë¡œë“œ (ì„ íƒ):</label><br>
  <input type="file" name="image" id="image"><br><br>

  <button type="submit">ê²Œì‹œí•˜ê¸°</button>
</form>

<!-- AJAX ìŠ¤í¬ë¦½íŠ¸ -->
<script>
  document.getElementById('challenge-select').addEventListener('change', function () {
    const challengeId = this.value;

    fetch(`/community/load-goals/?challenge_id=${challengeId}`)
      .then(response => response.json())
      .then(data => {
        const goalSelect = document.getElementById('goal-select');
        goalSelect.innerHTML = '<option value="">ì„¸ë¶€ ëª©í‘œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>';
        data.forEach(goal => {
          const option = document.createElement('option');
          option.value = goal.id;
          option.textContent = goal.content;
          goalSelect.appendChild(option);
        });
      });
  });
</script>

</body>
</html>
